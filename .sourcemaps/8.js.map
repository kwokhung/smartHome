{"version":3,"sources":["../../src/pages/ble-thermo-details/ble-thermo-details.module.ts","../../src/pages/ble-thermo-details/ble-thermo-details.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { BleThermoDetailsPage } from './ble-thermo-details';\n\n@NgModule({\n  declarations: [\n    BleThermoDetailsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(BleThermoDetailsPage),\n  ],\n  exports: [\n    BleThermoDetailsPage\n  ]\n})\nexport class BleThermoDetailsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/ble-thermo-details/ble-thermo-details.module.ts","import { Component, NgZone } from '@angular/core';\nimport { IonicPage } from 'ionic-angular';\nimport { NavController, NavParams, AlertController } from 'ionic-angular';\nimport { BLE } from '@ionic-native/ble';\n\n// Bluetooth UUIDs\nconst THERMOMETER_SERVICE = '4fafc201-1fb5-459e-8fcc-c5c9c331914b';\nconst TEMPERATURE_CHARACTERISTIC = 'beb5483e-36e1-4688-b7f5-ea07361b26a8';\n\n@IonicPage({\n  name: 'BleThermoDetailsPage'\n})\n@Component({\n  selector: 'page-ble-thermo-details',\n  templateUrl: 'ble-thermo-details.html',\n})\nexport class BleThermoDetailsPage {\n\n  peripheral: any = {};\n  temperature: number;\n  statusMessage: string;\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private ble: BLE,\n    private alertCtrl: AlertController,\n    private ngZone: NgZone) {\n\n    let device = navParams.get('device');\n\n    this.setStatus('Connecting to ' + device.name || device.id);\n\n    // This is not a promise, the device can call disconnect after it connects, so it's an observable\n    this.ble.connect(device.id).subscribe(\n      peripheral => this.onConnected(peripheral),\n      peripheral => this.showAlert('Disconnected', 'The peripheral unexpectedly disconnected')\n    );\n\n  }\n\n  // the connection to the peripheral was successful\n  onConnected(peripheral) {\n\n    this.peripheral = peripheral;\n    this.setStatus('Connected to ' + (peripheral.name || peripheral.id));\n\n    //this.showAlert(\"id\", peripheral.id);\n    //this.showAlert(\"service\", peripheral.services[2]);\n    //this.showAlert(\"characteristic\", peripheral.characteristics[4].characteristic);\n    \n    // Subscribe for notifications when the temperature changes\n    this.ble.startNotification(this.peripheral.id, THERMOMETER_SERVICE, TEMPERATURE_CHARACTERISTIC).subscribe(\n      data => this.onTemperatureChange(data),\n      () => this.showAlert('Unexpected Error', 'Failed to subscribe for temperature changes')\n    )\n\n    // Read the current value of the temperature characteristic\n    this.ble.read(this.peripheral.id, peripheral.services[2], peripheral.characteristics[4].characteristic).then(\n      data => this.onTemperatureChange(data),\n      () => this.showAlert('Unexpected Error', 'Failed to get temperature')\n    )\n\n  }\n\n  onTemperatureChange(buffer: ArrayBuffer) {\n\n    // var data = new Uint8Array(1);\n    // data[0] = 1;\n    // BLE.write(device_id, 'FF10', 'FF11', data.buffer);\n\n    // Temperature is a 1 byte floating point value\n    var data = new Uint8Array(buffer);\n    //this.showAlert(\"buffer\", data[0]);\n    this.setStatus('Temperature (degree): ' + data[0]);\n\n    console.log(data[0]);\n\n    this.ngZone.run(() => {\n      this.temperature = data[0];\n    });\n\n  }\n\n  // Disconnect peripheral when leaving the page\n  ionViewWillLeave() {\n    console.log('ionViewWillLeave disconnecting Bluetooth');\n    this.ble.disconnect(this.peripheral.id).then(\n      () => console.log('Disconnected ' + JSON.stringify(this.peripheral)),\n      () => console.log('ERROR disconnecting ' + JSON.stringify(this.peripheral))\n    )\n  }\n\n  showAlert(title, message) {\n    let alert = this.alertCtrl.create({\n      title: title,\n      subTitle: message,\n      buttons: ['OK']\n    });\n    alert.present();\n  }\n\n  setStatus(message) {\n    console.log(message);\n    this.ngZone.run(() => {\n      this.statusMessage = message;\n    });\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/ble-thermo-details/ble-thermo-details.ts"],"sourceRoot":""}