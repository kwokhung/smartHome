{"version":3,"sources":["../../src/pages/ble-light-details/ble-light-details.module.ts","../../src/pages/ble-light-details/ble-light-details.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { BleLightDetailsPage } from './ble-light-details';\n\n@NgModule({\n  declarations: [\n    BleLightDetailsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(BleLightDetailsPage),\n  ],\n  exports: [\n    BleLightDetailsPage\n  ]\n})\nexport class BleLightDetailsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/ble-light-details/ble-light-details.module.ts","import { Component, NgZone } from '@angular/core';\nimport { IonicPage } from 'ionic-angular';\nimport { NavController, NavParams, AlertController } from 'ionic-angular';\nimport { BLE } from '@ionic-native/ble';\n\n// Bluetooth UUIDs\nconst LIGHTBULB_SERVICE = '6E400001-B5A3-F393-E0A9-E50E24DCCA9E';\nconst SWITCH_CHARACTERISTIC = 'ff11';\nconst DIMMER_CHARACTERISTIC = '6E400003-B5A3-F393-E0A9-E50E24DCCA9E';\n\n@IonicPage({\n  name: 'BleLightDetailsPage'\n})\n@Component({\n  selector: 'page-ble-light-details',\n  templateUrl: 'ble-light-details.html',\n})\nexport class BleLightDetailsPage {\n\n  peripheral: any = {};\n  power: boolean;\n  brightness: number;\n  statusMessage: string;\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private ble: BLE,\n    private alertCtrl: AlertController,\n    private ngZone: NgZone) {\n\n    let device = navParams.get('device');\n\n    this.setStatus('Connecting to ' + device.name || device.id);\n\n    this.ble.connect(device.id).subscribe(\n      peripheral => this.onConnected(peripheral),\n      peripheral => this.showAlert('Disconnected', 'The peripheral unexpectedly disconnected')\n    );\n\n  }\n\n  onConnected(peripheral) {\n\n    this.peripheral = peripheral;\n\n    this.alertCtrl.create({\n      title: \"peripheral!\",\n      subTitle: JSON.stringify(peripheral),\n      buttons: [\"Close\"]\n    }).present();\n\n    this.setStatus('Connected to ' + (peripheral.name || peripheral.id));\n\n    // Update the UI with the current state of the switch characteristic\n    this.ble.read(this.peripheral.id, LIGHTBULB_SERVICE, SWITCH_CHARACTERISTIC).then(\n      buffer => {\n        let data = new Uint8Array(buffer);\n        console.log('switch characteristic ' + data[0]);\n        this.ngZone.run(() => {\n          this.power = data[0] !== 0;\n        });\n      }\n    )\n\n    // Update the UI with the current state of the dimmer characteristic\n    this.ble.read(this.peripheral.id, LIGHTBULB_SERVICE, DIMMER_CHARACTERISTIC).then(\n      buffer => {\n        this.alertCtrl.create({\n          title: \"buffer!\",\n          subTitle: JSON.stringify(buffer),\n          buttons: [\"Close\"]\n        }).present();\n        let data = new Uint8Array(buffer);\n        console.log('dimmer characteristic ' + data[0]);\n        this.ngZone.run(() => {\n          this.brightness = data[0];\n        });\n      },\n      (err) => {\n        this.alertCtrl.create({\n          title: \"err!\",\n          subTitle: JSON.stringify(err),\n          buttons: [\"Close\"]\n        }).present();\n      }\n    )\n  }\n\n  onPowerSwitchChange(event) {\n    console.log('onPowerSwitchChange');\n    let value = this.power ? 1 : 0;\n    let buffer = new Uint8Array([value]).buffer;\n    console.log('Power Switch Property ' + this.power);\n    this.ble.write(this.peripheral.id, LIGHTBULB_SERVICE, SWITCH_CHARACTERISTIC, buffer).then(\n      () => this.setStatus('Light is ' + (this.power ? 'on' : 'off')),\n      e => this.showAlert('Unexpected Error', 'Error updating power switch')\n    );\n  }\n\n  setBrightness(event) {\n    let buffer = new Uint8Array([this.brightness]).buffer;\n    this.ble.write(this.peripheral.id, LIGHTBULB_SERVICE, DIMMER_CHARACTERISTIC, buffer).then(\n      () => this.setStatus('Set brightness to ' + this.brightness),\n      e => this.showAlert('Unexpected Error', 'Error updating dimmer characteristic ' + e)\n    );\n  }\n\n  // Disconnect peripheral when leaving the page\n  ionViewWillLeave() {\n    console.log('ionViewWillLeave disconnecting Bluetooth');\n    this.ble.disconnect(this.peripheral.id).then(\n      () => console.log('Disconnected ' + JSON.stringify(this.peripheral)),\n      () => console.log('ERROR disconnecting ' + JSON.stringify(this.peripheral))\n    )\n  }\n\n  showAlert(title, message) {\n    let alert = this.alertCtrl.create({\n      title: title,\n      subTitle: message,\n      buttons: ['OK']\n    });\n    alert.present();\n  }\n\n  setStatus(message) {\n    console.log(message);\n    this.ngZone.run(() => {\n      this.statusMessage = message;\n    });\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/ble-light-details/ble-light-details.ts"],"sourceRoot":""}